<template>

  <div id="svgLinesContainer">

  <svg id="svgLines" width="100%" height="100%" viewBox="0 0 2401 1249" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">
  <g><g><path id="Crossrail_route_x" d="M0,585l0,213.9c0,16.458 13.542,30 30,30l130,0m-55,222.6c0,10.97 -9.028,20 -20,20l-55,0m1670,-434l10,7.5c8.65,6.49 19.18,10 30,10l61,0c27.43,0 50,-22.571 50,-50l0,-52.5c0,-15.726 7.42,-30.564 20,-40l506,-379.5" style="fill:none;"/><path id="Crossrail_x_stripe" d="M0,585l0,213.9c0,16.458 13.542,30 30,30l130,0m-55,222.6c0,10.97 -9.028,20 -20,20l-55,0m1670,-434l10,7.5c8.65,6.49 19.18,10 30,10l61,0c27.43,0 50,-22.571 50,-50l0,-52.5c0,-15.726 7.42,-30.564 20,-40l506,-379.5" style="fill:none;"/></g><g><path id="Crossrail_route" d="M921,698l166.75,0c10,0 19,-3 27,-9l92.25,-69.5l36,-27c8,-6 17,-9 27,-9l85,0c13.33,0 24,5.333 32,16l5,5.5c8,10.667 18.67,16 32,16l100,0m0,0l138,0c10,0 19,3 27,9l11,7.5l107.62,80.5c8,6 17,9 27,9l155.38,0c10,0 19,-3 27,-9l12,-9c8,-6 17,-9 27,-9l137,0c10,0 19,3 27,9l133.33,100" style="fill:none;"/><path id="Crossrail_stripe" d="M921,698l166.75,0c10,0 19,-3 27,-9l92.25,-69.5l36,-27c8,-6 17,-9 27,-9l85,0c13.33,0 24,5.333 32,16l5,5.5c8,10.667 18.67,16 32,16l100,0m0,0l138,0c10,0 19,3 27,9l11,7.5l107.62,80.5c8,6 17,9 27,9l155.38,0c10,0 19,-3 27,-9l12,-9c8,-6 17,-9 27,-9l137,0c10,0 19,3 27,9l133.33,100" style="fill:none;"/></g></g><g><path id="Crossrail_Heathrow_route" d="M160,828.9l-10,0c-24.686,0 -45,20.314 -45,45l0,233.1m55,-278.1l320,0c10.713,-0.591 21.075,-4.044 30,-10l137.2,-102.9c8.925,-5.956 19.287,-9.409 30,-10l225.04,0" style="fill:none;"/><path id="Crossrail_Heathrow_stripe" d="M160,828.9l-10,0c-24.686,0 -45,20.314 -45,45l0,233.1m55,-278.1l320,0c10.713,-0.591 21.075,-4.044 30,-10l137.2,-102.9c8.925,-5.956 19.287,-9.409 30,-10l225.04,0" style="fill:none;"/></g><g><path id="Waterloo_and_City_line_route" d="M1469.5,663l0,5c0,13.333 -5.33,24 -16,32l-103.14,77.355c-10.67,8 -16,18.667 -16,32l0,29.625" style="fill:none;"/><path id="Waterloo_and_City_line_route1" d="M1469.5,663l0,5c0,13.333 -5.33,24 -16,32l-103.14,77.355c-10.67,8 -16,18.667 -16,32l0,29.625" style="fill:none;"/></g><path id="Jubilee_line_route" d="M651,267l0,132c0,8.229 6.771,15 15,15l195,0c13.333,0 24,5.333 32,16l300,400c8,10.667 18.67,16 32,16l85,0c10,0 19,-3 27,-9l64,-48c8,-6 17,-9 27,-9l282,0c10,0 19,-3 27,-9l12,-9c8,-6 17,-9 27,-9l230,0c10.97,0 20,-9.028 20,-20l0,-223c0,-9.735 -3.16,-19.212 -9,-27l-36,-48" style="fill:none;"/><path id="Hammersmith_and_City_line_route" d="M981,664c-10.6,7.95 -23.5,12.25 -36.75,12.25l-15,0c-14.332,0 -28.284,4.651 -39.75,13.25l-30,22.5c-7.788,5.841 -17.265,9 -27,9l-60,0c-10.817,0 -21.347,3.51 -30,10l-90,67.5c-11.323,8.492 -18,21.847 -18,36l0,105.5m346.5,-276l192,-144c25.65,-19.242 56.87,-29.65 88.93,-29.65c46.62,0 90.6,21.995 118.57,59.29l26.5,34.36c7.55,10.065 19.42,16 32,16l124,0c14.47,0 28.12,6.826 36.8,18.4l18,24c8,10.667 18.67,16 32,16l3.2,0c9.74,0 19.21,-3.159 27,-9l137.07,-102.9c8.65,-6.49 19.18,-10 30,-10l193.93,0c9.74,0 19.21,-3.159 27,-9l90,-67.5" style="fill:none;"/><path id="Central_line_route" d="M340,823.9l20,0c10,0 19,-3 27,-9l28,-21c14.181,-10.636 33.819,-10.636 48,0l35,26c8,6 17,9 27,9l412,0c10,0 19,-3 27,-9l248,-185.9c8,-6 17,-9 27,-9l136,0c13.33,0 24,5.333 32,16l15,20c8,10.667 18.67,16 32,16c10,0 19,-3 27,-9l136,-102c8,-6 17,-9 27,-9l136,0c10,0 19,-3 27,-9l176,-132c13.17,-9.875 15.88,-28.834 6,-42l-54,-72c-6,-8 -9,-17 -9,-27l0,-274m-1302,827.9l-99,0c-10,0 -19,-3 -27,-9l-340,-255c-10.667,-8 -16,-18.667 -16,-32l0,-150.4m1784,-127.5c0,-16.458 13.54,-30 30,-30l125,0c16.46,0 30,-13.542 30,-30l0,-50c0,-16.458 -13.54,-30 -30,-30l-120,0c-16.46,0 -30,13.542 -30,30l0,6" style="fill:none;"/><g><path id="Northern_line_Battersea_extension_base" d="M1380.5,964l-20,15c-8,6 -17,9 -27,9l-90,0c-10,0 -19,3 -27,9l-35,26.25c-8,6 -17,9 -27,9l-20.5,0" style="fill:none;"/><path id="Northern_line_Battersea_extension" d="M1380.5,964l-20,15c-8,6 -17,9 -27,9l-90,0c-10,0 -19,3 -27,9l-35,26.25c-8,6 -17,9 -27,9l-20.5,0" style="fill:none;"/></g><path id="Northern_line_route" d="M706,229.5l196.67,147.5c8,6 17,9 27,9l235.33,0c20.3,0 37,16.702 37,37l0,42c0,8.667 -6.5,17.333 -19.5,26c-13,8.667 -19.5,17.333 -19.5,26l0,49.667c0,6.667 2,12.667 6,18l106,141.333c6,8 9,17 9,27c0,10 3,19 9,27l102,136c3.78,5.148 5.82,11.373 5.82,17.761c0,9.577 -4.58,18.596 -12.32,24.239m-534.5,-848.5l270,202.5c10.67,8 16,18.667 16,32l0,17c0,13.715 11.29,25 25,25c13.71,0 25,11.285 25,25l0,55c0,10.149 8.35,18.5 18.5,18.5l180.5,0c49.37,0 90,40.627 90,90l0,295.5c0,13.333 -5.33,24 -16,32l-462.5,347m-20.5,-1045c-8,-6 -17,-9 -27,-9l-40,0" style="fill:none;"/><path id="Victoria_line_route" d="M1682,218l-259,0c-16.46,0 -30,13.542 -30,30l0,40c0,10 3,19 9,27l9,12c6,8 9,17 9,27l0,85.5c0,21.943 -18.06,40 -40,40l-187,0c-21.94,0 -40,18.057 -40,40l0,320.83c0,13.333 4,25.333 12,36l140,186.67" style="fill:none;"/><path id="Bakerloo_line_route" d="M529,344l0,82c0,14.153 6.677,27.508 18,36l329,246.75c15.953,11.965 38.047,11.965 54,0c28,-21 12,-37.5 40,-58.5l1,-0.75l26,-19.5c7.11,-6 15.11,-8.667 24,-8l70,0c13.33,0 24,5.333 32,16l87,116c8,10.667 18.67,16 32,16l17.5,0c13.33,0 24,5.333 32,16l53.25,71c7.55,10.065 19.42,16 32,16l98.25,0" style="fill:none;"/><path id="Piccadilly_line_route" d="M20,404l288,0c8.653,0 17.077,2.808 24,8l36,27c10.065,7.548 16,19.419 16,32l0,327.4c0,12.581 5.935,24.452 16,32l160,120c7.788,5.841 17.265,9 27,9l433.3,0c28.23,0 55.72,-9.161 78.3,-26.1c10.67,-8 16,-18.667 16,-32l0,-75.5c0,-12.581 5.94,-24.452 16,-32l143.4,-107.55c10.07,-7.548 16,-19.419 16,-32l0,-257.25c0,-13.333 5.33,-24 16,-32l61,-45.75c10.67,-8 16,-18.667 16,-32l0,-52.25c0,-13.333 -5.33,-24 -16,-32l-212,-158m-518,914.4l-50,0c-9.735,0 -19.212,-3.159 -27,-9l-90,-67.4c-24.816,-18.612 -59.184,-18.612 -84,0l-226,169.5c-8,6 -17,9 -27,9l-103,0m130,-9l-60,45c-3.461,2.6 -7.673,4 -12,4c-10.972,0 -20,-9.03 -20,-20c0,-7.51 4.229,-14.41 10.92,-17.82" style="fill:none;"/><g><path id="DLR_routes" d="M1481.5,675l115,0c6.67,0 14.17,2.5 22.5,7.5c8.33,5 15.83,7.5 22.5,7.5l218.5,0c10.97,0 20,9.028 20,20l0,325m-278.5,-345l768.5,0c10.97,0 20,-9.028 20,-20l0,-50m-510,415l0,-325c0,-6.29 2.97,-12.226 8,-16l4,-3c5.03,-3.774 8,-9.71 8,-16l0,-120m50,-178l75,100c7.14,9.519 11,21.102 11,33l0,160c0,10.972 9.03,20 20,20l2.67,0c4.33,0 8.54,1.404 12,4l141.33,106c8,6 17,9 27,9l49,0" style="fill:none;"/><path id="DLR_routes_stripe" d="M1481.5,675l115,0c6.67,0 14.17,2.5 22.5,7.5c8.33,5 15.83,7.5 22.5,7.5l218.5,0c10.97,0 20,9.028 20,20l0,325m-278.5,-345l768.5,0c10.97,0 20,-9.028 20,-20l0,-50m-510,415l0,-325c0,-6.29 2.97,-12.226 8,-16l4,-3c5.03,-3.774 8,-9.71 8,-16l0,-120m50,-178l75,100c7.14,9.519 11,21.102 11,33l0,160c0,10.972 9.03,20 20,20l2.67,0c4.33,0 8.54,1.404 12,4l141.33,106c8,6 17,9 27,9l49,0" style="fill:none;"/></g><g><path id="District_Olympia_branch" d="M871,974.4l-4,0c-19.749,0 -36,-16.251 -36,-36l0,-14.4" style="fill:none;"/><path id="District_Olympia_branch_stripe" d="M871,974.4l-4,0c-19.749,0 -36,-16.251 -36,-36l0,-14.4" style="fill:none;"/></g><path id="District_line_route" d="M987,672l-54,40.5c-63.855,47.891 -76.991,139.845 -29.1,203.7c4.721,6.295 7.275,13.956 7.275,21.825c0,19.955 -16.42,36.375 -36.375,36.375l-7.8,0c-19.749,0 -36,16.25 -36,36l0,55.1c0,9.74 3.159,19.21 9,27l99,132m-599,-390.6l19.67,0c12.98,0 25.616,4.212 36,12l155.33,116.5c10.384,7.788 23.02,12 36,12l433,0c31.48,0 62.12,-10.214 87.3,-29.1l325.7,-243.8c7.79,-5.841 17.27,-9 27,-9l103,0c9.95,0 19.64,-3.229 27.6,-9.2l14.67,-11c8,-6 17,-9 27,-9l20.73,0c10.82,0 21.35,-3.51 30,-10l137.07,-102.8c7.79,-5.841 17.27,-9 27,-9l193.93,0c10.82,0 21.35,-3.51 30,-10l330,-247.5m-1764,690.4l-50,0c-12.98,0 -25.616,-4.212 -36,-12l-36,-27c-16.101,-12.341 -38.649,-12.341 -54.75,0l-99.25,75" style="fill:none;"/><g><g id="North_and_West_London_Lines_route"><path id="West_London_Line_route" d="M696.5,571l-48,36c-10.667,8 -16,18.667 -16,32l0,100c0,13.333 5.333,24 16,32l161.5,121.125c10.667,8 16,18.667 16,32l0,105.875c0,13.33 5.333,24 16,32l20,15c8,6 17,9 27,9l209.33,0" style="fill:none;"/><path id="North_London_Line_route" d="M696.5,571l141.33,-106c8,-6 17,-9 27,-9l47.67,0c10,0 19,-3 27,-9l24,-18c10.67,-8 16,-18.667 16,-32l0,-36c0,-16.458 13.54,-30 30,-30l107.5,0c10,0 19,3 27,9l68,51c8,6 17,9 27,9l694,0c10,0 19,3 27,9l20,15m-1283.5,147l-124,93c-10.667,8 -16,18.667 -16,32l0,141c0,13.333 -5.333,24 -16,32l-182.5,137.4" style="fill:none;"/></g><g id="North_and_West_London_Lines_route_stripe"><path id="West_London_Line_route1" d="M696.5,571l-48,36c-10.667,8 -16,18.667 -16,32l0,100c0,13.333 5.333,24 16,32l161.5,121.125c10.667,8 16,18.667 16,32l0,105.875c0,13.33 5.333,24 16,32l20,15c8,6 17,9 27,9l209.33,0" style="fill:none;"/><path id="North_London_Line_route1" d="M696.5,571l141.33,-106c8,-6 17,-9 27,-9l47.67,0c10,0 19,-3 27,-9l24,-18c10.67,-8 16,-18.667 16,-32l0,-36c0,-16.458 13.54,-30 30,-30l107.5,0c10,0 19,3 27,9l68,51c8,6 17,9 27,9l694,0c10,0 19,3 27,9l20,15m-1283.5,147l-124,93c-10.667,8 -16,18.667 -16,32l0,141c0,13.333 -5.333,24 -16,32l-182.5,137.4" style="fill:none;"/></g></g><g><path id="Watford_DC_Line_route" d="M534,125l0,301c0,12.581 5.935,24.452 16,32l212,159" style="fill:none;"/><path id="Watford_DC_Line_stripe" d="M534,125l0,301c0,12.581 5.935,24.452 16,32l212,159" style="fill:none;"/></g><path id="Metropolitan_line_route" d="M100,165l300,225c8,6 17,9 27,9l434,0c17.299,0 33.621,8.161 44,22l141,188c4.94,6.583 14.42,7.937 21,3l112,-84c23.92,-17.938 53.02,-27.64 82.92,-27.64c43.47,0 84.48,20.507 110.56,55.28l26.52,34.36c9.44,12.581 24.27,20 40,20l124,0c19.75,0 36,16.251 36,36m-1459,-451c-10.667,-8 -16,-18.667 -16,-32l0,-20m115,126.25c-10.667,-8 -16,-18.667 -16,-32l0,-52.25m-203,214l420,0" style="fill:none;"/><g><path id="Watford_DC_Line_route_over" d="M762,617l16,12c15.953,11.965 38.047,11.965 54,0l200.2,-150.15c8,-6 17,-9 27,-9l113.73,0" style="fill:none;"/><path id="Watford_DC_Line_over_stripe" d="M762,617l16,12c15.953,11.965 38.047,11.965 54,0l200.2,-150.15c8,-6 17,-9 27,-9l113.73,0" style="fill:none;"/></g><g><path id="Crossrail_Shenfield_route" d="M1564,580l166.58,0c10.82,0 21.35,-3.51 30,-10l85.42,-64c8.65,-6.49 19.18,-10 30,-10c10.82,0 21.35,-3.51 30,-10l471,-353" style="fill:none;"/><path id="Crossrail_Shenfield_stripe" d="M1564,580l166.58,0c10.82,0 21.35,-3.51 30,-10l85.42,-64c8.65,-6.49 19.18,-10 30,-10c10.82,0 21.35,-3.51 30,-10l471,-353" style="fill:none;"/></g><g><g><path id="Gospel_Oak_to_Barking_Line_extension_route" d="M2159.5,462l45,60c8,10.667 18.67,16 32,16l153.5,0" style="fill:none;"/><path id="Gospel_Oak_to_Barking_Line_extension_route_stripe" d="M2159.5,462l45,60c8,10.667 18.67,16 32,16l153.5,0" style="fill:none;"/></g><g><path id="Gospel_Oak_to_Barking_Line_route" d="M1030,321c10,0 19,-3 27,-9l80,-60c8,-6 17,-9 27,-9l700,0c26.67,0 48,10.667 64,32l54,72c8,10.667 18.67,16 32,16l51,0c13.33,0 24,5.333 32,16l62.5,83" style="fill:none;"/><path id="Gospel_Oak_to_Barking_Line_route_stripe" d="M1030,321c10,0 19,-3 27,-9l80,-60c8,-6 17,-9 27,-9l700,0c26.67,0 48,10.667 64,32l54,72c8,10.667 18.67,16 32,16l51,0c13.33,0 24,5.333 32,16l62.5,83" style="fill:none;"/></g><g><path id="Seven_Sisters_Line_routes" d="M1564,590l28.67,0c8.65,0 17.08,-2.808 24,-8l2.33,-1.75c10.67,-8 16,-18.667 16,-32l0,-153.25c0,-13.333 -5.33,-24 -16,-32l-200,-150c-10.67,-8 -16,-18.667 -16,-32l0,-67.5c0,-12.581 5.93,-24.452 16,-32l90,-67.5m-106,99.5l0,-70m161,546.5l28.67,0c8.65,0 17.08,-2.808 24,-8l2.33,-1.75c10.67,-8 16,-18.667 16,-32l0,-153.25c0,-13.333 5.33,-24 16,-32l15,-11.25c10.67,-8 16,-18.667 16,-32l0,-191.75" style="fill:none;"/><path id="Seven_Sisters_Line_routes_stripe" d="M1564,590l28.67,0c8.65,0 17.08,-2.808 24,-8l2.33,-1.75c10.67,-8 16,-18.667 16,-32l0,-153.25c0,-13.333 -5.33,-24 -16,-32l-200,-150c-10.67,-8 -16,-18.667 -16,-32l0,-67.5c0,-12.581 5.93,-24.452 16,-32l90,-67.5m-106,99.5l0,-70m161,546.5l28.67,0c8.65,0 17.08,-2.808 24,-8l2.33,-1.75c10.67,-8 16,-18.667 16,-32l0,-153.25c0,-13.333 5.33,-24 16,-32l15,-11.25c10.67,-8 16,-18.667 16,-32l0,-191.75" style="fill:none;"/></g><g><path id="Romford_to_Upminster_Line_route" d="M2257,223l30,0c13.33,0 24,5.333 32,16l21.75,29c8,10.667 18.67,16 32,16l28.25,0" style="fill:none;"/><path id="Romford_to_Upminster_Line_route_stripe" d="M2257,223l30,0c13.33,0 24,5.333 32,16l21.75,29c8,10.667 18.67,16 32,16l28.25,0" style="fill:none;"/></g><g><path id="East_London_Line_Battersea_Park_branch" d="M1240.5,1051l-130.5,0" style="fill:none;"/><path id="East_London_Line_Battersea_Park_branch_stripe" d="M1240.5,1051l-130.5,0" style="fill:none;"/></g><g><path id="East_and_South_London_Lines_route" d="M1420,410l100.62,0c13.34,0 24,5.333 32,16l138.38,184.5c6,8 9,17 9,27l0,232.5c0,13.333 -5.33,24 -16,32l-186.67,140c-8,6 -17,9 -27,9l-310.33,0c-10,0 -19,3 -27,9l-34.67,26m601.67,-448.5l0,232.5c0,13.333 5.33,24 16,32l28.67,21.5m-44.67,-286l0,354.5c0,13.33 -5.33,24 -16,32l-280,210m200,-150l-28,21c-8,6 -17,9 -27,9l-35,0" style="fill:none;"/><path id="East_and_South_London_Lines_route_stripe" d="M1420,410l100.62,0c13.34,0 24,5.333 32,16l138.38,184.5c6,8 9,17 9,27l0,232.5c0,13.333 -5.33,24 -16,32l-186.67,140c-8,6 -17,9 -27,9l-310.33,0c-10,0 -19,3 -27,9l-34.67,26m601.67,-448.5l0,232.5c0,13.333 5.33,24 16,32l28.67,21.5m-44.67,-286l0,354.5c0,13.33 -5.33,24 -16,32l-280,210m200,-150l-28,21c-8,6 -17,9 -27,9l-35,0" style="fill:none;"/></g></g><path id="Central_line_route_over" d="M142,382.5l0,116.5" style="fill:none;"/><g><path id="DLR_route_over" d="M1900,555l0,-32c0,-12.581 5.93,-24.452 16,-32l73,-54.75" style="fill:none;"/><path id="DLR_route_stripe_over" d="M1900,555l0,-32c0,-12.581 5.93,-24.452 16,-32l73,-54.75" style="fill:none;"/></g></svg>

  <div id="svgLinesContainerOverlay"></div>
  </div>

</template>

<script>
export default {
  data() {
    return {};
  },
  computed: {
    svgPaths() {
      return [...document.querySelectorAll('#svgLinesContainer path')];
    }
  },
  methods: {
    randColour() {	// util fn to randomise icon colour
      let col = '#'+(0x1000000+(Math.random())*0xffffff).toString(16).substr(1,6);
      while ( col === '#000000' ) col = '#'+(0x1000000+(Math.random())*0xffffff).toString(16).substr(1,6);
      return col;
    },
    triggerDraw(path, draw = true) {
      if (path === undefined) return false; // check for path
      // set random duration
      let duration = Math.floor(Math.random() * (6000 - 2000) + 2000);
      let length = path.getTotalLength(); // path length
      path.style.transition = `stroke-dashoffset ${duration / 1000}s ease-in-out, stroke 1s ease-in`; // animate the stroke

      if (draw) { // draw in
        path.style.strokeDashoffset = 0;
        path.style.stroke = `${this.randColour()}`; // colour change
      setTimeout( (e) => {
          path.style.strokeDashoffset = length;
          this.triggerDraw(path, false); // recusively call self
      }, duration);
      }
      else { // draw out
        path.style.strokeDashoffset = length;
        path.style.stroke = `${this.randColour()}`; // colour change
      setTimeout( (e) => {
          path.style.strokeDashoffset = 0;
          this.triggerDraw(path, true); // recusively call self
      }, duration);
      }
    }
  },
  mounted() {
    // only do the animation on desktop - too resource heavy
    if (window.matchMedia("(min-width: 768px)").matches) {
      this.svgPaths.forEach( (path) => {
        // get path length and init stroke. Starts offest to hide lines
        let length = path.getTotalLength();
        path.style.strokeDasharray = length;
        path.style.strokeDashoffset = length;
        path.style.strokeWidth = '2px';
        setTimeout( (e) => { // trigger draw fn
          this.triggerDraw(path, true);
        }, 250);
      });
    }
    else {
      this.svgPaths.forEach( (path) => {
        path.style.strokeDashoffset = 0;
        path.style.stroke = `${this.randColour()}`; // colour change
        path.style.strokeWidth = '2px';
      });
    }
  }
};
</script>

<style scoped lang="scss">
  #svgLinesContainer {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    max-width: 100%;
    max-height: 100%;
    z-index: -1;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #svgLinesContainerOverlay {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    z-index: 0;
    background: rgba(0,0,0,0.5);
  }
  #svgLines {
    min-width: 2000px;
    path {
      stroke-dashoffset: 1000;
      transition: stroke 1s ease-in;
      stroke: #bde1ff; // fb
      stroke: transparent;
      stroke-width: 1px;
      fill: none;
      opacity: 0.9 !important;
    }
  }
</style>
